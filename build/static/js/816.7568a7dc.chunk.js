"use strict";(self.webpackChunkavoweather=self.webpackChunkavoweather||[]).push([[816],{4816:(e,o,i)=>{i.r(o),i.d(o,{getDeviceLocation:()=>s,getLocationPermissionHelp:()=>l,isNativePlatform:()=>n,requestLocationPermission:()=>r});var a=i(9379),t=i(4180);const n=()=>{var e;return"undefined"!==typeof window&&window.hasOwnProperty("Capacitor")&&(null===(e=window.Capacitor)||void 0===e?void 0:e.isNativePlatform())},r=async()=>{try{if(!n())return!!navigator.geolocation&&new Promise((e=>{navigator.geolocation.getCurrentPosition((()=>e(!0)),(o=>{(0,t.yx)("requestLocationPermission",{message:"Permesso di geolocalizzazione negato",code:o.code,details:o.message}),e(!1)}),{timeout:5e3})}));try{const{Geolocation:e,Permissions:o}=await Promise.resolve().then(i.bind(i,5403));if(o){const e=await o.query({name:"geolocation"});if("denied"===e.state||"never_ask_again"===e.state)return!1;if("prompt"===e.state){return"granted"===(await o.request({name:"geolocation"})).state}return"granted"===e.state}return await e.getCurrentPosition(),!0}catch(e){return(0,t.yx)("requestLocationPermission",{message:"Errore durante la richiesta del permesso di geolocalizzazione nativa",details:e}),!1}}catch(e){return(0,t.yx)("requestLocationPermission",e),!1}},s=async e=>{try{const s=(0,a.A)({enableHighAccuracy:!0,timeout:1e4,maximumAge:0},e);if(!await r())return(0,t.yx)("getDeviceLocation","Permesso di geolocalizzazione non concesso"),null;if(!n())return new Promise((e=>{navigator.geolocation.getCurrentPosition((o=>{e({lat:o.coords.latitude,lon:o.coords.longitude})}),(o=>{let i="Errore sconosciuto durante il recupero della geolocalizzazione.";switch(o.code){case o.PERMISSION_DENIED:i="Permesso di geolocalizzazione negato dall'utente.";break;case o.POSITION_UNAVAILABLE:i="Informazioni sulla posizione non disponibili.";break;case o.TIMEOUT:i="Timeout durante il tentativo di recuperare la posizione."}(0,t.yx)("getDeviceLocation",{message:i,code:o.code,details:o.message}),e(null)}),s)}));try{const{Geolocation:e}=await Promise.resolve().then(i.bind(i,5403)),o=await e.getCurrentPosition(s);return{lat:o.coords.latitude,lon:o.coords.longitude}}catch(o){return(0,t.yx)("getDeviceLocation",{message:"Errore durante il recupero della posizione nativa",details:o}),null}}catch(o){return(0,t.yx)("getDeviceLocation",o),null}},l=()=>{if(!n())return"Per utilizzare la geolocalizzazione, accetta il permesso nel prompt del browser. Se l'hai negato in precedenza, puoi ripristinarlo dalle impostazioni del sito.";const e=navigator.userAgent.toLowerCase();return e.indexOf("iphone")>-1||e.indexOf("ipad")>-1||e.indexOf("ipod")>-1?"Per attivare la geolocalizzazione su iOS, vai in Impostazioni > Privacy > Servizi di localizzazione > AVOWeather e seleziona 'Mentre usi l'app'.":"Per attivare la geolocalizzazione su Android, vai in Impostazioni > App > AVOWeather > Autorizzazioni > Posizione e seleziona 'Consenti'."}}}]);
//# sourceMappingURL=816.7568a7dc.chunk.js.map